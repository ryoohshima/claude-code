# Claude Code ユーザー設定

このファイルには、全プロジェクト共通で適用される開発ガイドラインを記載しています。

## 基本設定

- 言語: 日本語で回答する
- コードスタイル: シンプルで読みやすいコードを優先

## Core Principles

- **シンプルさ第一（Simplicity First）**: すべての変更を可能な限りシンプルにする。コードへの影響を最小限に抑える。
- **怠慢の排除（No Laziness）**: 根本原因を突き止める。一時的な場当たり的修正は行わない。シニア開発者の基準を維持する。
- **影響の最小化（Minimal Impact）**: 必要な箇所のみを変更する。新たなバグの混入を防ぐ。依頼された範囲のみ変更し、不要なリファクタリングや「改善」は行わない。変更が広範囲に及ぶ場合は事前に確認する。

## Workflow Orchestration

### 1. プランモードのデフォルト化

- 非自明なタスク（3ステップ以上、または設計上の決定が必要なもの）では、必ずプランモード（計画策定）に入る。
- 計画通りに進まない場合は、直ちに停止して再計画する。無理に押し進めないこと。
- 構築だけでなく、検証ステップにもプランモードを活用する。
- 曖昧さを排除するため、事前に詳細な仕様を記述する。

### 2. サブエージェント戦略

- メインのコンテキストウィンドウをクリーンに保つため、サブエージェントを積極的に活用する。
- 調査、探索、並列分析などはサブエージェントにオフロードする。
- 複雑な問題に対しては、サブエージェントを通じて計算リソースを投入する。
- 集中して実行できるよう、1人のサブエージェントにつき1つのタスクを割り当てる。

### 3. 自己改善ループ

- ユーザーから修正を受けた後は、必ず `tasks/lessons.md` にそのパターンを記録する。
- 同じミスを防ぐためのルールを自分自身に対して記述する。
- ミス率が下がるまで、これらの教訓を徹底的に反復適用する。
- セッション開始時に、関連プロジェクトの教訓を確認する。

### 4. 完了前の検証

- 動作を証明するまでは、タスクを完了とマークしない。
- 関連する場合は、変更前後の動作の差分（Diff）を確認する。
- 「スタッフエンジニアがこれを承認するか？」と自問自答する。
- テストを実行し、ログを確認し、正当性を実証する。

### 5. エレガンスの追求（バランス重視）

- 些細ではない変更の場合、一度立ち止まって「よりエレガントな方法はないか？」を検討する。
- 修正が「その場しのぎ」だと感じたら、「今の知識を持った状態で、最初からエレガントな解決策を実装する」こと。
- 単純で明白な修正にはこれを行わず、オーバーエンジニアリングを避ける。
- 提出前に、自分の成果物に対して批判的な視点を持つ。

### 6. 自律的なバグ修正

- バグ報告を受けたら、手助けを求めずに修正する。
- ログ、エラー、失敗しているテストを指摘し、それらを解決する。
- ユーザーにコンテキストの切り替えを要求しない。
- 指示を待たずに、失敗しているCIテストを修正する。

## タスク管理

1. **計画優先（Plan First）**: `tasks/todo.md` にチェック可能な項目を含む計画を書き出す。
2. **計画検証（Verify Plan）**: 実装を開始する前に、ユーザーに確認を行う。
3. **進捗管理（Track Progress）**: 進捗に合わせて項目を完了としてマークする。
4. **変更の説明（Explain Changes）**: 各ステップでハイレベルな（要点をまとめた）概要を説明する。
5. **結果の記録（Document Results）**: `tasks/todo.md` にレビューセクションを追加する。
6. **教訓の集約（Capture Lessons）**: 修正を受けた後、`tasks/lessons.md` を更新する。

## コマンド実行の原則

- スラッシュコマンド実行時は、必ず該当する定義ファイル（.md）を確認する
- 現状に関わらず、定義された手順を省略しない
- 手順を省略すべき状況だと判断した場合は、先にユーザーに確認する

## その他ガイドライン

rules/ ディレクトリ内のガイドラインを参照する

- coding-guideline.md
- git-guidline.md
